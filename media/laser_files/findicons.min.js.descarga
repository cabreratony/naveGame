+function(c){c("#navbar-toggle-language").click(function(){if(c("#langModal").length>0){c("#langModal").modal()}else{c.get("/ajax/language",function(e){c(e).modal()})}});update_captcha=function(e,f,g){e=typeof e!=="undefined"?e:5;f=typeof f!=="undefined"?f:"";g=typeof g!=="undefined"?g:0;c.get("/accounts/captcha/new?length="+e+"&app="+f+"&change="+g,function(h){c("img#captcha").attr("src","/accounts/captcha/"+h);c("input#captcha_uid").val(h)})};update_dialog_captcha=function(e,f,g){e=typeof e!=="undefined"?e:5;f=typeof f!=="undefined"?f:"";g=typeof g!=="undefined"?g:0;c.get("/accounts/captcha/new?length="+e+"&app="+f+"&change="+g,function(h){c("img#dialog_captcha").attr("src","/accounts/captcha/"+h);c("input#dialog_captcha_uid").val(h)})};show_captcha=function(e,f){if(e.show_captcha){c("div#captcha").show();update_captcha(5,f)}};show_dialog_captcha=function(e,f){if(e.show_captcha){c("div#dialog_captcha").show();c.colorbox.resize();update_dialog_captcha(length=5,f=f)}};bind_dialog_buttons=function(e){c("a.close-dialog").click(function(){c(this).colorbox.close()})};bind_message_dialog_buttons=function(e){c("a.ui-button").click(function(){c(this).colorbox.close()})};process_field_errors=function(e){c(".tooltip.error").each(function(){var g=c(this).attr("id");var f=c(this).attr("id").replace("field_error_","");if(e.field_errors&&f in e.field_errors){c(this).find(".tooltip-inner").html(e.field_errors[f]);c(this).show()}else{c(this).find(".tooltip-inner").html("");c(this).hide()}});if(e.field_errors==undefined&&e.error!=undefined){show_message_dialog(e.error,"error")}};show_message_dialog=function(h,f,e,i){var g={success:"fa-check-circle",info:"fa-exclamation-circle",warning:"fa-exclamation-triangle",danger:"fa-times-circle"};var j=function(k){modal=c(this);modal.find(".message").html(h);if(f in g){modal.find(".modal-body .h4").addClass("text-"+f);modal.find(".modal-body .h1>i").addClass(g[f]);modal.find(".modal-body .h1").show()}else{modal.find(".modal-body .h4").removeClass("text-success text-info text-warning text-danger");modal.find(".modal-body .h1").hide()}if(i){modal.find(".btn-cancel").show()}else{modal.find(".btn-cancel").hide()}modal.find(".btn-ok").click(function(){modal.modal("hide");if(typeof e==="function"){e.call()}else{if(e){location.href=e}}});modal.find(".btn-cancel").click(function(){modal.modal("hide")})};c.get("/ajax/message/dialog",function(k){var l=c(k);l.on("show.bs.modal",j);l.modal();l.on("hide.bs.modal",function(){l.remove()})})};function d(){var e=c("#message-modal");if(e.length>0){e.modal("hide")}}show_dialog=function(e){var f=c(e).modal();f.on("hide.bs.modal",function(){f.remove()});bind_dialog_plugins(f);return f};bind_dialog_plugins=function(e){if(e.find("select[data-toggle=iselect]").length){e.find("select[data-toggle=iselect]").selectOrDie()}if(e.find('[data-toggle="icheck"]').length){e.find('[data-toggle="icheck"]').iCheck()}if(e.find(".switch").length){e.find(".switch").iswitch()}e.find(".tooltip.error").click(function(){c(this).fadeTo(400,0,function(){c(this).slideUp(400)});return false});e.find(".btn-close").click(function(){e.modal("hide")})};show_alert=function(f,e){var g=c("<div/>",{"class":"alert alert-"+e+" alert-dismissible",role:"alert"});g.append('<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>');g.append(f);g.appendTo("#messages")};clean_alert=function(){c("#messages").empty()};bindDownloadButton=function(){c("a.downloadlink").click(function(f){f.preventDefault();f.stopPropagation();var e=c(this).attr("href");c.getJSON(e,{},function(g){if(g.success){location.href=e}else{show_message_dialog(g.error,"warning")}})});c("a.no_file").click(function(){c.get("/ajax/message?type=nofile&text="+c(this).text(),function(e){show_message_dialog(e)})})};bindMoreButton=function(){a(c("a.more_format"))};bindInfoBox=function(){c("div.info_box").click(function(f){var e=f.pageX-this.offsetLeft;var g=f.pageY-this.offsetTop;if(e<20|g<20){c(this).parent().find("a.info_link img").attr("src","/static/images/info_g.png");c(this).remove()}})};bindFavoriteButton=function(){function e(h){var i=c(h);i.click(function(){if(c(this).hasClass("favorited")){var j=i.siblings("a").attr("title");c.get("/ajax/message?type=pack_in_fav&text="+j,function(l){var k=function(){c.getJSON("/ajax/favorite/pack",{pack:i.data("packid"),action:"delete"},function(m){show_message_dialog(pack_removed_from_fav,"success");i.removeClass("favorited")})};show_message_dialog(l,"warning",k,true)})}else{c.getJSON("/ajax/favorite/pack",{pack:i.data("packid")},function(k){if(k.success){i.addClass("favorited");show_message_dialog(k.data)}else{show_message_dialog(k.error)}})}return false})}function g(k,j,h){old_set_id=k.find(".modal-body").data("current-set-id");old_set_name=k.find(".modal-body").data("current-set-name");if(k.find("ul.set_list a.active").length==0){k.find(".save_button").addClass("disabled")}k.find("a.create-set-link").click(function(){k.find(".add-set-form-group").removeClass("hide");k.find(".add-set-button-group").addClass("hide")});function i(l){l.preventDefault();k.find("li a").removeClass("active");c(this).addClass("active");j.addClass("active");new_set_name=j.text();if(old_set_name!=undefined){if(new_set_name!=old_set_name){c.get("/ajax/message?type=moveicon&text="+old_set_name+"&text2="+new_set_name,function(m){k.find("#tips").html(m)})}else{c.get("/ajax/message?type=icon_in_set&text="+old_set_name,function(m){k.find("#tips").html(m);k.find(".save_button").addClass("disabled")})}}else{c.get("/ajax/message?type=favicon&text="+new_set_name,function(m){k.find("#tips").html(m)})}k.find(".save_button").removeClass("disabled")}k.find("li a").click(i);k.find("#add_set_button").click(function(m){m.preventDefault();var l=k.find("#new-set-name").val();c.getJSON("/ajax/favorite/userset",{action:"add",new_name:l},function(n){if(n.success){k.find("ul.set_list a").removeClass("active");k.find("ul.set_list").append(n.data);k.find("ul.set_list a").last().click(i).addClass("active")}else{k.find("#tips").html(n.error)}})});k.find(".save_button").click(function(l){l.preventDefault();params={action:"add",new_set:k.find("ul.set_list a.active").attr("rel"),icon:h};if(old_set_name!=undefined){params={action:"move",old_set:old_set_id,new_set:k.find("ul.set_list a.active").attr("rel"),icon:h}}c.getJSON("/ajax/favorite/icon",params,function(m){j.addClass("favorited");if(j.data("on")){j.html(j.data("on"))}k.modal("hide")})});k.find(".delete_button").click(function(l){l.preventDefault();c.getJSON("/ajax/favorite/icon",{action:"delete",old_set:old_set_id,icon:h},function(m){j.removeClass("favorited");if(j.data("off")){j.html(j.data("off"))}k.modal("hide")})});k.find(".btn-cancel, close_button").click(function(){k.modal("hide")})}function f(i){var j=c(i);var l=j.attr("id");if(l.substr(0,3)=="fav"){var j=j;var h=l.split("_")[1];var k=c("#favoritesModal");if(k.length>0){k.modal("hide")}j.click(function(m){m.preventDefault();c.get(j.attr("href"),function(n){var o=c(n);o.on("show.bs.modal",function(){g(o,j,h)});o.modal();o.on("hide.bs.modal",function(){o.remove()})})})}else{j.click(function(m){m.preventDefault();show_message_dialog(login_required,"info")})}}c("a.favorite").each(function(h){if(c(this).hasClass("fav_pack")){e(this)}else{f(this)}})};bindFavoriteButton();function a(){c("a.more_format").click(function(g){var e=c(this).attr("url");var h=c("img#image_"+e).attr("src");var f="/ajax/convert?icon="+e+"&png_file="+h+"&output_format="+c(this).html().toLowerCase();g.preventDefault();c.getJSON(f,{},function(i){if(i.success){location.href="/ajax/download?filename="+i.data}else{show_message_dialog(i.error,"warning")}})})}a();bindInfoButton=function(){c("a.infolink").click(function(f){var k=c(this).next(".infomenu"),j=c(".infomenu"),i=c(this).closest(".items").offset().left,m=k.width(),n=c(document.body).width();if(k.is(":visible")){k.hide();c(this).removeClass("active")}else{c("a.infolink").removeClass("active");c(this).addClass("active");j.removeClass("right").hide();if(i+m+32>n){k.addClass("right")}k.show()}var l=c(this).attr("id").replace("info_","");var g=c(this).attr("rel");var h=c(this).siblings(".infomenu");var e="/ajax/icon/info/"+l+"?width="+g;if(c(this).siblings(".infomenu").find("dl").length==0){c.getJSON(e,{},function(o){if(o.success){h.html(o.data)}else{show_message_dialog(o.error,"warning")}})}})};bindInfoButton();function b(e){var f=c("div#favorite_con");f.find("div").remove();c.ajax({type:"GET",url:"/my/"+e,cache:false,success:function(g){f.empty();f.html(g);bindDownloadButton();a();bindFavoriteButton();bindInfoButton()}})}c(".userset-button").click(function(){var e=c(this).data("userset-id");b(e)});c("#fav-create-userset-button").click(function(f){var e=c("input[name=new_set_name]").val();c.getJSON("/ajax/favorite/userset",{action:"add",new_name:e},function(g){if(g.success){location.reload()}else{show_message_dialog(g.error,"warning")}})});c("#usersets .edit").click(function(f){f.preventDefault();var e=c(this);c.get("/ajax/favorite/userset",{action:"openedit",userset:c(this).data("userset-id")},function(g){var h=c(g);h.on("show.bs.modal",function(){h.find(".switch").iswitch();h.find(".save-button").click(function(){var i=c("form[name=edit_set] input#new_name").val();var j=c("form[name=edit_set]").serialize();c.getJSON("/ajax/favorite/userset?"+j,function(k){if(k.success){h.modal("hide");show_message_dialog(k.data);e.parent().siblings(".userset-button").html(i)}})})});h.modal();h.on("hide.bs.modal",function(){h.remove()})})});c("#usersets .delete").click(function(f){f.preventDefault();var e=c(this);c.get("/ajax/favorite/userset",{action:"before_delete",userset:c(this).data("userset-id")},function(g){var h=c(g);h.on("show.bs.modal",function(){h.find("select[name=target]").selectOrDie();h.find(".switch").iswitch();h.find(".save-button").click(function(){var i=c("form[name=delete_set]").serialize();c.getJSON("/ajax/favorite/userset?"+i,function(j){if(j.success){h.modal("hide");show_message_dialog(userset_removed);e.parent().parent().remove()}})})});h.modal();h.on("hide.bs.modal",function(){h.remove()})})});c("#iconpacks .delete").click(function(g){g.preventDefault();var f=c(this);var e=c(this).data("packid");var h=c(this).parent().siblings("a").html();show_message_dialog(ask_to_remove_pack,"warning",function(){c.getJSON("/ajax/favorite/pack",{pack:e,action:"delete"},function(i){f.parent().parent().remove();f.parents(".btn-group-favourite").find("li:first").click()})})});c("#add_tag").click(function(){var f=c(this);var e=f.parent().siblings("input");e.fadeOut("slow");c.getJSON("/ajax/add_tag?icon="+f.attr("rel")+"&tags="+e.val(),function(g){if(g.success){show_message_dialog(g.data,"success")}else{show_message_dialog(g.error,"warning")}e.fadeIn("slow")})});c("select.filter-select").change(function(){var e=c(this).attr("name");location.href=updateQueryStringParameter(location.href,e,c(this).val())});c("input.filter-search").keydown(function(f){if(f.which==13){var e=c(this).attr("name");location.href=updateQueryStringParameter(location.href,e,c(this).val());f.preventDefault()}});c("input#keyword").autocomplete({serviceUrl:"/ajax/search/suggest",preserveInput:false,formatResult:function(e,f){if(!f){return e.value}var g="("+c.Autocomplete.utils.escapeRegExChars(f)+")";return e.value.replace(new RegExp(g,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")+e.data},onSelect:function(e){location.href="/search/"+e.value}})}(jQuery);function updateQueryStringParameter(c,a,d){var b=new RegExp("([?|&])"+a+"=.*?(&|$)","i");separator=c.indexOf("?")!==-1?"&":"?";if(c.match(b)){return c.replace(b,"$1"+a+"="+d+"$2")}else{return c+separator+a+"="+d}}function removeQueryStringParameter(b,h){var e=b.split("?");if(e.length>=2){var a=e.shift();var g=e.join("?");var f=encodeURIComponent(h)+"=";var d=g.split(/[&;]/g);for(var c=d.length;c-->0;){if(d[c].lastIndexOf(f,0)!==-1){d.splice(c,1)}}b=a+"?"+d.join("&")}return b};